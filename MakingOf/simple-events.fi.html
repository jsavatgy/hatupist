<h1>Tapahtumankäsittelyä</h1>

<p>Tarkastellaan lähdekoodia: <a href="simple-events.hs">simple-events.hs</a></p>

<p>Ohjelma luo tutun ikkunan.</p>

<p><img src="simple-events.png" alt="" /></p>

<p>Lähdekoodi: <a href="https://github.com/jsavatgy/hatupist/blob/master/MakingOf/simple-events.hs">simple-events.hs</a></p>

<h2>Tekstikentän tekstin muutos</h2>

<p>Funktiolla <code>onEditableChanged</code> tekstikenttä <code>entry</code> saa tapahtumankäsittelijän <code>entryTextChanged</code>.</p>

<pre><code>  entry  &lt;- entryNew
  entrySetHasFrame entry False
  boxPackStart vbox entry PackNatural 3
  onEditableChanged entry ( 
    entryTextChanged entry)
</code></pre>

<p>Tapahtumankäsittelijän toiminta on yksinkertainen, se tulostaa tapahtuman nimen, sen POSIX-ajan ja tekstikentän tekstin ruudulle.</p>

<pre><code>entryTextChanged entry = do 
  txt &lt;- entryGetText entry
  pt  &lt;- getPOSIXTime
  putStrLn ("Entry ## " ++ (show pt) ++ ": " ++ txt)
  return ()
</code></pre>

<h2>Ajastintapahtuma</h2>

<p>Ajastin alustetaan funktiolla <code>timeoutAdd</code>. Ensimmäinen parametri on tapahtumankäsittelifunktio <code>timeIsOut</code>. Toinen parametri on aika millisekunteina.</p>

<pre><code>  timeoutAdd timeIsOut 1000
</code></pre>

<p>Myös tämä tapahtumankäsittelijä on toiminnaltaan yksinkertainen, tulostaen tapahtuman nimen ja POSIX-ajan.</p>

<pre><code>timeIsOut = do
  pt &lt;- getPOSIXTime
  putStrLn ("Timer ## " ++ show pt)
  return True
</code></pre>

<p>Tyypillinen käyttökerta tulostaa</p>

<pre><code>$ runhaskell simple-events.hs 
Timer ## 1413918113.807756s
Entry ## 1413918114.648762s: x
Timer ## 1413918114.808328s
Entry ## 1413918115.200725s: xx
Entry ## 1413918115.662261s: xxx
Timer ## 1413918115.80882s
Entry ## 1413918116.278175s: xxxx
Timer ## 1413918116.810192s
Entry ## 1413918117.120765s: xxxx 
Entry ## 1413918117.478783s: xxxx x
Entry ## 1413918117.682427s: xxxx xx
Timer ## 1413918117.81128s
Timer ## 1413918118.812609s
Timer ## 1413918119.813201s
$ 
</code></pre>
